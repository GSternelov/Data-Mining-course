---
title: "Data Mining - Lab 1 - Cluster Analysis"
author: "Gustav Sternel√∂v"
date: "3 februari 2016"
output: pdf_document
---

# Simple K-means
I start with making a scatterplot which includes all variables except *names*. The latter is excluded because it just gives the names of the respective products. An alternative could have been to create a categorical variable since the names of the products indicates quite well what kind of food it contains. However, K-means is not a good algorithm for categorical data so the variable would still not have been so interesting to include in this particular analysis.  
```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(RWeka)
library(ggplot2)
library(gridExtra)
library(GGally)

food <- read.arff("C:\\Users\\Gustav\\Desktop\\Data Mining - Master\\food.arff")
ggpairs(food[, 2:6], title = "Scatterplot matrix",axisLabels="internal",upper = list(continuous = "points"),lower= list(continuous = "points"))
foodVars <- food[, c(2:4, 6)]
```
The chosen attributes are *Energy*, *Protein*, *Fat* and *Iron*. 
This is motivated by the patterns visualised in the scatterplot. My conclusion is that all of the variables but *calcium* seem to be interesting to include. For *calcium* most of the values are very close to each other apart from some outliers. It is therefore interpreted as not being the most interesting variable to include. The other variables have values that are more spread out in different groups which might be possible to investigate closer with a cluster analysis.    

\pagebreak  
  
## Seed 10  
The initial clusters centroids are held fixed with the seed value *10* and two different cluster analysis are performed. In the first case the data points are divided into two clusters and in the second case into four different clusters.  
**Use K=3 or K=4 in the second case?** 

### Two clusters
The number of iterations is two and the within cluster *SSE* is 3.99. The first cluster contains *1/3* of the data points and the second cluster the remainder of the data points. How the initial starting points has changed can be seen in the output below. 

```{r, echo=FALSE}
Kmeans2 <- SimpleKMeans(foodVars, Weka_control(N=2))
Kmeans2
```
Another way to present the obtained clusters are through visualisation. How the data points for each variable are clustered into the respective clusters is shown by the graphs below.   
**Exclude iron or not?**

```{r, echo=FALSE, fig.height=5.5}
{
  means2Var12 <- ggplot(food, aes(x=Energy, y=Protein)) + geom_point(aes(col=Kmeans2$class_ids),size=3) + theme(legend.position="none") +
  ggtitle("Energy vs Protein")
means2Var13 <- ggplot(food, aes(x=Energy, y=Fat)) + geom_point(aes(col=Kmeans2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Fat")
means2Var14 <- ggplot(food, aes(x=Energy, y=Iron)) + geom_point(aes(col=Kmeans2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Iron")
means2Var23 <- ggplot(food, aes(x=Protein, y=Fat)) + geom_point(aes(col=Kmeans2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Fat")
means2Var24 <- ggplot(food, aes(x=Protein, y=Iron)) + geom_point(aes(col=Kmeans2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Iron")
means2Var34 <- ggplot(food, aes(x=Fat, y=Iron)) + geom_point(aes(col=Kmeans2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Fat vs Iron")
grid.arrange(means2Var12, means2Var13,means2Var14,means2Var23,means2Var24,means2Var34, ncol=2)
}
```


### Four clusters
For the clustering with *K=...* the number of iterations is ... and the *SSE* is ... . Information about gow many of the points that are clustered into each cluster and how the initial staring points has changed is given in the output below.  
```{r, echo=FALSE}
Kmeans4 <- SimpleKMeans(foodVars, Weka_control(N=3))
Kmeans4
```


```{r, echo=FALSE, fig.height=5.5}
{
  means4Var12 <- ggplot(food, aes(x=Energy, y=Protein)) + geom_point(aes(col=Kmeans4$class_ids),size=3) + theme(legend.position="none") +
  ggtitle("Energy vs Protein") +  scale_colour_gradientn(colours = rainbow(3))
means4Var13 <- ggplot(food, aes(x=Energy, y=Fat)) + geom_point(aes(col=Kmeans4$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Fat")+  scale_colour_gradientn(colours = rainbow(3))
means4Var14 <- ggplot(food, aes(x=Energy, y=Iron)) + geom_point(aes(col=Kmeans4$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Iron")+  scale_colour_gradientn(colours = rainbow(3))
means4Var23 <- ggplot(food, aes(x=Protein, y=Fat)) + geom_point(aes(col=Kmeans4$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Fat")+  scale_colour_gradientn(colours = rainbow(3))
means4Var24 <- ggplot(food, aes(x=Protein, y=Iron)) + geom_point(aes(col=Kmeans4$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Iron")+  scale_colour_gradientn(colours = rainbow(3))
means4Var34 <- ggplot(food, aes(x=Fat, y=Iron)) + geom_point(aes(col=Kmeans4$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Fat vs Iron")+  scale_colour_gradientn(colours = rainbow(3))
grid.arrange(means4Var12, means4Var13,means4Var14,means4Var23,means4Var24,means4Var34, ncol=2)
}
```
\pagebreak
  
## Seed 28
The seed is changed to the value *28*. This means that the starting centroids will have changed for the clusters presented below. The starting points are chosen "randomly" 
### Two clusters
```{r,echo=FALSE}
Kmeans2v2 <- SimpleKMeans(foodVars, Weka_control(N=2, S=28))
Kmeans2v2
```

```{r,echo=FALSE, fig.height=5.5}
{
  means2v2Var12 <- ggplot(food, aes(x=Energy, y=Protein)) + geom_point(aes(col=Kmeans2v2$class_ids),size=3) + theme(legend.position="none") +
  ggtitle("Energy vs Protein")
means2v2Var13 <- ggplot(food, aes(x=Energy, y=Fat)) + geom_point(aes(col=Kmeans2v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Fat")
means2v2Var14 <- ggplot(food, aes(x=Energy, y=Iron)) + geom_point(aes(col=Kmeans2v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Iron")
means2v2Var23 <- ggplot(food, aes(x=Protein, y=Fat)) + geom_point(aes(col=Kmeans2v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Fat")
means2v2Var24 <- ggplot(food, aes(x=Protein, y=Iron)) + geom_point(aes(col=Kmeans2v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Iron")
means2v2Var34 <- ggplot(food, aes(x=Fat, y=Iron)) + geom_point(aes(col=Kmeans2v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Fat vs Iron")
grid.arrange(means2v2Var12, means2v2Var13,means2v2Var14,means2v2Var23,means2v2Var24,means2v2Var34, ncol=2)
}
```


### Four clusters

```{r,echo=FALSE}
Kmeans4v2 <- SimpleKMeans(foodVars, Weka_control(N=4,S=28))
Kmeans4v2
```


```{r,echo=FALSE, fig.height=5.5}
{
  means4v2Var12 <- ggplot(food, aes(x=Energy, y=Protein)) + geom_point(aes(col=Kmeans4v2$class_ids),size=3) + theme(legend.position="none") +
  ggtitle("Energy vs Protein") +  scale_colour_gradientn(colours = rainbow(4))
means4v2Var13 <- ggplot(food, aes(x=Energy, y=Fat)) + geom_point(aes(col=Kmeans4v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Fat")+  scale_colour_gradientn(colours = rainbow(4))
means4v2Var14 <- ggplot(food, aes(x=Energy, y=Iron)) + geom_point(aes(col=Kmeans4v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Energy vs Iron")+  scale_colour_gradientn(colours = rainbow(4))
means4v2Var23 <- ggplot(food, aes(x=Protein, y=Fat)) + geom_point(aes(col=Kmeans4v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Fat")+  scale_colour_gradientn(colours = rainbow(4))
means4v2Var24 <- ggplot(food, aes(x=Protein, y=Iron)) + geom_point(aes(col=Kmeans4v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Protein vs Iron")+  scale_colour_gradientn(colours = rainbow(4))
means4v2Var34 <- ggplot(food, aes(x=Fat, y=Iron)) + geom_point(aes(col=Kmeans4v2$class_ids),size=3)+ theme(legend.position="none")+
  ggtitle("Fat vs Iron")+  scale_colour_gradientn(colours = rainbow(4))
grid.arrange(means4v2Var12, means4v2Var13,means4v2Var14,means4v2Var23,means4v2Var24,means4v2Var34, ncol=2)
}
```


# MakeDensityBasedClusters
